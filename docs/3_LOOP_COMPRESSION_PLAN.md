# 3-Loop UX Compression Plan
**Strategic Reduction: 5 Tabs ‚Üí 3 Loops**

## üéØ Vision

Transform CultureWalletv2 from a **feature-per-tab architecture** to a **relationship-first architecture** by collapsing navigation into 3 core loops that match the original CultureWallet vision:

1. **Community** - Connect, trust, communicate
2. **Wallet** - Value exchange with TRST
3. **Culture** - Recognition, collectibles, status

---

## üìä Current State Analysis

### Current Navigation (5 Tabs)
```
Friends   Circle   Signals   Messages   Boost
  ‚Üì         ‚Üì         ‚Üì         ‚Üì         ‚Üì
Contact  Trust    Recognition  XMTP     Viral
  Mgmt   Alloc      Feed       Chat   Mechanics
```

**Problems:**
- User bounces between tabs to interact with ONE relationship
- Mental overhead: "Where do I send a signal?" "Where's trust?"
- Features feel disconnected despite being relationship-coded
- New users confused by number of surfaces

### Hidden/Secondary Surfaces
- Collections (GHHA NFTs)
- Recognition Cards (metadata)
- Profile / Settings
- QR Scanner
- Onboarding

**Total surfaces: 11+**

---

## üéØ Proposed 3-Loop Structure

### Loop 1: COMMUNITY üë•
**Purpose:** All relationship-based interactions

```
COMMUNITY HOME
‚îú‚îÄ Ring of 9 (mini trust circle)
‚îÇ  ‚îî‚îÄ Tap to see full circle management
‚îÇ
‚îú‚îÄ Contacts List
‚îÇ  ‚îú‚îÄ Avatar + Name + Trust indicator
‚îÇ  ‚îú‚îÄ Last activity preview
‚îÇ  ‚îî‚îÄ Tap ‚Üí Contact Drawer
‚îÇ
‚îú‚îÄ Messages Preview
‚îÇ  ‚îú‚îÄ Recent XMTP conversations
‚îÇ  ‚îî‚îÄ Tap ‚Üí Full conversation
‚îÇ
‚îî‚îÄ + Add Contact (FAB)
   ‚îî‚îÄ Opens QR scanner

CONTACT DRAWER (Slide-up on contact tap)
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ [Avatar] Tony Camero           ‚îÇ
‚îÇ Trust: üî•üî•üî• (3/9)            ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ [üí¨ Message]  [‚ö° Send Signal] ‚îÇ
‚îÇ [üî• Trust]     [üí∞ Send TRST]  ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Recent Activity:               ‚îÇ
‚îÇ ‚Ä¢ Signal: "Great execution" 2h ‚îÇ
‚îÇ ‚Ä¢ Message: "Thanks!" 5h        ‚îÇ
‚îÇ ‚Ä¢ Trust allocated 2d           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**Eliminates:**
- Friends tab (becomes Community home)
- Messages tab (becomes action in drawer + preview)
- Circle tab (becomes Ring of 9 widget + drawer action)

---

### Loop 2: WALLET üí∞
**Purpose:** TRST balance and value exchange

```
WALLET HOME
‚îú‚îÄ TRST Balance Card
‚îÇ  ‚îú‚îÄ Large balance display
‚îÇ  ‚îú‚îÄ USD equivalent
‚îÇ  ‚îî‚îÄ Recent change indicator
‚îÇ
‚îú‚îÄ Quick Actions
‚îÇ  ‚îú‚îÄ [Send TRST]    ‚Üí Opens contact picker
‚îÇ  ‚îú‚îÄ [Request TRST] ‚Üí Generate QR/link
‚îÇ  ‚îî‚îÄ [Add Funds]    ‚Üí Future: Brinks/Brale
‚îÇ
‚îî‚îÄ Transaction History
   ‚îú‚îÄ Sent/Received
   ‚îú‚îÄ Timestamps
   ‚îî‚îÄ Tap ‚Üí Detail view
```

**Adds:** (Future Sprint 2+)
- TRST payments
- Transaction history
- Brinks/Brale cash-to-TRST flow

---

### Loop 3: CULTURE üé®
**Purpose:** Recognition, collectibles, cultural status

```
CULTURE HOME
‚îú‚îÄ Recognition Feed (scrollable)
‚îÇ  ‚îú‚îÄ Filter: All | From Me | To Me
‚îÇ  ‚îú‚îÄ Signal cards with boost counts
‚îÇ  ‚îî‚îÄ Pull-to-refresh
‚îÇ
‚îú‚îÄ + Create Signal (FAB)
‚îÇ  ‚îî‚îÄ Opens recognition modal
‚îÇ
‚îú‚îÄ My Collectibles
‚îÇ  ‚îú‚îÄ GHHA Membership NFTs
‚îÇ  ‚îÇ  ‚îú‚îÄ Tier badge (Bronze/Silver/Gold/Platinum)
‚îÇ  ‚îÇ  ‚îú‚îÄ Benefits summary
‚îÇ  ‚îÇ  ‚îî‚îÄ Tap ‚Üí Full collection view
‚îÇ  ‚îÇ
‚îÇ  ‚îî‚îÄ Recognition Cards Earned
‚îÇ     ‚îú‚îÄ By category (Leadership, Execution, etc.)
‚îÇ     ‚îî‚îÄ Rarity indicators
‚îÇ
‚îî‚îÄ Boost Activity (when implemented)
   ‚îú‚îÄ Signals boosted
   ‚îú‚îÄ Viral momentum tracking
   ‚îî‚îÄ Shareable boost links
```

**Eliminates:**
- Signals tab (becomes Culture feed)
- Boost tab (becomes Culture section)
- Collections tab (becomes Culture section)

**Moves to subpages:**
- Recognition Cards detail ‚Üí `/recognition-cards` (kept for deep links)
- Collection detail ‚Üí `/collections/[tokenId]/[serial]`

---

## üîÑ Data Flow Remains Unchanged

**Key Insight:** This is a UI reorganization, not a backend change.

All existing services remain:
- SignalsStore (recognition events)
- HCS topics (contact, trust, signals, profile)
- XMTP client (messaging)
- Mirror Node (NFT queries)
- Magic.link (authentication)

The compression happens at the **component level**, not the data level.

---

## üìê Contact Drawer Architecture

The **Contact Drawer** is the keystone component - it collapses 4 interactions into 1 surface:

```typescript
// Contact Drawer Component
interface ContactDrawerProps {
  contactId: string
  onClose: () => void
}

const ContactDrawer = ({ contactId, onClose }) => {
  // Fetch all relationship data
  const contact = useContact(contactId)
  const trustStatus = useTrustStatus(contactId)
  const recentMessages = useRecentMessages(contactId, 3)
  const recentSignals = useRecentSignals(contactId, 3)
  
  return (
    <Drawer>
      <Header>
        <Avatar src={contact.avatar} />
        <Name>{contact.name}</Name>
        <TrustIndicator count={trustStatus.trustCount} max={9} />
      </Header>
      
      <Actions>
        <MessageButton onClick={() => openXMTP(contactId)} />
        <SignalButton onClick={() => openRecognitionModal(contactId)} />
        <TrustButton 
          active={trustStatus.inCircle}
          onClick={() => toggleTrust(contactId)}
        />
        <PaymentButton onClick={() => openPaymentModal(contactId)} />
      </Actions>
      
      <ActivityFeed>
        {[...recentMessages, ...recentSignals]
          .sort((a, b) => b.timestamp - a.timestamp)
          .slice(0, 5)
          .map(event => <ActivityItem key={event.id} event={event} />)
        }
      </ActivityFeed>
    </Drawer>
  )
}
```

---

## üó∫Ô∏è Route Structure

### Bottom Navigation (3 Tabs)
```
/community   (Community Loop)
/wallet      (Wallet Loop)
/culture     (Culture Loop)
```

### Preserved Routes (for deep linking)
```
/recognition-cards           (Culture subpage)
/recognition-cards/[id]      (Signal detail)
/collections                 (Culture subpage)
/collections/[tokenId]/[serial]  (NFT detail)
/messages                    (redirects to Community)
/circle                      (redirects to Community)
/signals                     (redirects to Culture)
```

### Auth & Meta Routes (unchanged)
```
/                  (Landing)
/onboard           (Onboarding)
/me                (Profile)
/settings          (Settings)
/qr                (QR Scanner - launched from Community)
```

---

## üé® Component Architecture

### New Components
```
Community Loop:
‚îú‚îÄ CommunityHome
‚îú‚îÄ RingOfNine (trust circle widget)
‚îú‚îÄ ContactsList
‚îú‚îÄ MessagesPreview
‚îú‚îÄ ContactDrawer ‚≠ê (KEY COMPONENT)
‚îú‚îÄ AddContactFAB
‚îî‚îÄ QRScannerModal

Wallet Loop:
‚îú‚îÄ WalletHome
‚îú‚îÄ TRSTBalanceCard
‚îú‚îÄ QuickActionsBar
‚îú‚îÄ TransactionHistory
‚îú‚îÄ SendTRSTModal
‚îî‚îÄ RequestTRSTModal

Culture Loop:
‚îú‚îÄ CultureHome
‚îú‚îÄ RecognitionFeed
‚îú‚îÄ CreateSignalFAB
‚îú‚îÄ MyCollectiblesSection
‚îÇ  ‚îú‚îÄ GHHAMembershipCards
‚îÇ  ‚îî‚îÄ RecognitionCardsGrid
‚îî‚îÄ BoostActivitySection
```

### Refactored Components
```
Existing components move INTO loops:
- ContactsList ‚Üí CommunityHome
- TrustCircleVisualization ‚Üí RingOfNine widget
- SignalsFeed ‚Üí RecognitionFeed
- CollectionsPage ‚Üí MyCollectiblesSection
```

---

## üìã Implementation Phases

### Phase 1: Contact Drawer (Week 1)
**Goal:** Build the keystone component

**Tasks:**
1. Create ContactDrawer component
2. Wire up 4 action buttons (Message, Signal, Trust, Pay)
3. Add activity feed (recent messages + signals)
4. Integrate with existing services (no new backend needed)
5. Test slide-up animation and gesture handling

**Deliverable:** Working contact drawer that launches from anywhere

---

### Phase 2: Community Loop (Week 2)
**Goal:** Collapse Friends + Circle + Messages into Community

**Tasks:**
1. Create CommunityHome layout
2. Build RingOfNine widget (simplified Circle visualization)
3. Move ContactsList into Community
4. Add MessagesPreview section
5. Update navigation: Replace 3 tabs with 1 Community tab
6. Redirect old routes: /circle ‚Üí /community, /messages ‚Üí /community

**Deliverable:** Single Community tab with all relationship features

---

### Phase 3: Culture Loop (Week 3)
**Goal:** Collapse Signals + Boost + Collections into Culture

**Tasks:**
1. Create CultureHome layout
2. Move SignalsFeed to top of Culture
3. Build MyCollectiblesSection
4. Integrate GHHA membership cards
5. Add RecognitionCards grid
6. Keep CreateSignal FAB
7. Redirect old routes: /signals ‚Üí /culture, /boost ‚Üí /culture

**Deliverable:** Single Culture tab with recognition + collectibles

---

### Phase 4: Wallet Loop (Week 4)
**Goal:** Create clean TRST balance + payments surface

**Tasks:**
1. Create WalletHome layout
2. Build TRSTBalanceCard (large, prominent)
3. Add QuickActionsBar (Send, Request, Add Funds)
4. Create TransactionHistory component
5. Build SendTRSTModal with contact picker
6. Integrate with existing TRST infrastructure

**Deliverable:** Working Wallet tab with TRST operations

---

### Phase 5: Polish & Testing (Week 5)
**Goal:** Smooth transitions and mobile optimization

**Tasks:**
1. Optimize drawer animations
2. Test gesture handling (swipe-to-close, etc.)
3. Mobile responsiveness testing
4. Update onboarding flow for 3-loop structure
5. Analytics: Track which loop features get most use
6. Bug fixes and performance optimization

**Deliverable:** Production-ready 3-loop navigation

---

## üìä Success Metrics

### User Behavior
- **Reduced tab switches:** Expect 60% reduction in navigation events
- **Increased contact engagement:** More actions per contact (message + signal + trust)
- **Faster task completion:** Time to send signal or message reduced by 40%

### System Metrics
- **Component reuse:** 80%+ of existing components reused
- **Bundle size:** Minimal change (just reorganization)
- **Performance:** No degradation (same data loading)

### User Feedback
- **Onboarding success:** New users understand 3 loops faster than 5 tabs
- **Power user approval:** Existing users adapt within 1 week
- **Support tickets:** Reduced "where is X?" questions

---

## üöß Rollout Strategy

### Option A: Big Bang (Recommended)
**When:** After Phase 5 complete
**How:** Ship 3-loop navigation all at once
**Pros:** Clean break, no confusion
**Cons:** Requires user re-learning

### Option B: Gradual Migration
**When:** Ship phase by phase
**How:** Community first, then Culture, then Wallet
**Pros:** Less disruptive
**Cons:** Inconsistent experience during transition

**Recommendation:** Option A with:
- In-app tutorial for first login after update
- "What's New" modal explaining 3 loops
- Old routes redirect with toast: "Now in Community tab"

---

## üîÆ Future Enhancements

### Post-3-Loop Optimizations

**Smart Contact Drawer:**
- AI-suggested actions based on relationship history
- "You usually send Tony a signal on Fridays"
- Quick reply suggestions

**Cross-Loop Integration:**
- Pay someone while messaging them (Wallet ‚Üí Community)
- Send signal after completing payment (Wallet ‚Üí Culture)
- Boost signal in Culture tab, message contact in Community tab

**Contextual Navigation:**
- Bottom nav adapts based on current activity
- Community tab highlights when message received
- Culture tab highlights when signal received

---

## üìö Technical Details

### State Management
No changes needed - existing patterns work:
- SignalsStore for HCS events
- React Query for API data
- LocalStorage for session
- XMTP client state

### API Layer
No changes needed - same endpoints:
- `/api/hcs/events` (signals)
- `/api/trust/allocate` (trust)
- `/api/contact/*` (contacts)
- Mirror Node (NFTs)

### Performance
- Lazy load drawer content
- Virtualized lists for feeds
- Optimistic UI updates
- Background sync unchanged

---

## ‚úÖ Checklist

### Pre-Implementation
- [ ] Review plan with team
- [ ] Design mockups for 3 loops
- [ ] Design contact drawer interactions
- [ ] Plan data migration (if any)

### During Implementation
- [ ] Build ContactDrawer (Phase 1)
- [ ] Build Community loop (Phase 2)
- [ ] Build Culture loop (Phase 3)
- [ ] Build Wallet loop (Phase 4)
- [ ] Testing & polish (Phase 5)

### Post-Launch
- [ ] Monitor analytics
- [ ] Gather user feedback
- [ ] Iterate on drawer interactions
- [ ] Add cross-loop features

---

## üéØ Summary

This compression:
1. **Reduces cognitive load** - 5 tabs ‚Üí 3 loops (40% reduction)
2. **Matches mental model** - Relationships first, not features
3. **Preserves all functionality** - Nothing lost, just reorganized
4. **Improves task completion** - Fewer navigation jumps
5. **Aligns with data model** - HCS events are relationship-coded
6. **Sets up future scaling** - 3 loops can grow without nav bloat

**The Contact Drawer is the key** - it collapses 4 interaction types (message, signal, trust, pay) into 1 unified relationship surface.

This is the right move for CultureWalletv2.

---

**Document Version:** 1.0  
**Status:** Planning Phase  
**Ready for:** Design mockups + implementation
